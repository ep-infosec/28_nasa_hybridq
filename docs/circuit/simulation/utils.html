<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>hybridq.circuit.simulation.utils API documentation</title>
<meta name="description" content="Author: Salvatore Mandra (salvatore.mandra@nasa.gov) …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>hybridq.circuit.simulation.utils</code></h1>
</header>
<section id="section-intro">
<p>Author: Salvatore Mandra (salvatore.mandra@nasa.gov)</p>
<p>Copyright © 2021, United States Government, as represented by the Administrator
of the National Aeronautics and Space Administration. All rights reserved.</p>
<p>The HybridQ: A Hybrid Simulator for Quantum Circuits platform is licensed under
the Apache License, Version 2.0 (the "License"); you may not use this file
except in compliance with the License. You may obtain a copy of the License at
<a href="http://www.apache.org/licenses/LICENSE-2.0.">http://www.apache.org/licenses/LICENSE-2.0.</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed
under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.</p>
<h2 id="types">Types</h2>
<p><strong><code>Array</code></strong>: <code>numpy.ndarray</code></p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Author: Salvatore Mandra (salvatore.mandra@nasa.gov)

Copyright © 2021, United States Government, as represented by the Administrator
of the National Aeronautics and Space Administration. All rights reserved.

The HybridQ: A Hybrid Simulator for Quantum Circuits platform is licensed under
the Apache License, Version 2.0 (the &#34;License&#34;); you may not use this file
except in compliance with the License. You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0.

Unless required by applicable law or agreed to in writing, software distributed
under the License is distributed on an &#34;AS IS&#34; BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.

Types
-----
**`Array`**: `numpy.ndarray`
&#34;&#34;&#34;

from __future__ import annotations
from hybridq.utils import sort, argsort
import numpy as np
import numba


@numba.vectorize
def _parity(v):
    v ^= v &gt;&gt; 16
    v ^= v &gt;&gt; 8
    v ^= v &gt;&gt; 4
    v &amp;= 0xf
    if (0x6996 &gt;&gt; v) &amp; 1:
        return -1
    else:
        return 1


def prepare_state(state: str,
                  d: {int, iter[int]} = 2,
                  complex_type: any = &#39;complex64&#39;):
    &#34;&#34;&#34;
    Prepare initial state accordingly to `state`.

    Parameters
    ----------
    state: str
        State used to prepare the quantum state. If `state` is a string, a
        quantum state of `len(str)` is created using the following notation:

        - `0`: qubit is set to `0` in the computational basis,
        - `1`: qubit is set to `1` in the computational basis,
        - `+`: qubit is set to `+` state in the computational basis,
        - `-`: qubit is set to `-` state in the computational basis.
    d: {int, iter[int]}
        Dimensions of qubits.
    complex_type: any, optional
        Complex type to use to prepare the quantum state.

    Returns
    -------
    Array
        Quantum state prepared from `state`.

    Example
    -------
    &gt;&gt;&gt; prepare_state(&#39;+-+&#39;)
    array([ 0.35355338+0.j,  0.35355338+0.j, -0.35355338+0.j, -0.35355338+0.j,
            0.35355338+0.j,  0.35355338+0.j, -0.35355338+0.j, -0.35355338+0.j],
          dtype=complex64)
    &#34;&#34;&#34;
    # Convert state to str
    try:
        state = str(state)
    except:
        raise ValueError(&#34;&#39;state&#39; must be convertible to &#39;str&#39;.&#34;)

    # Get dimensions
    try:
        d = (int(d),) * len(state)
    except:
        d = tuple(int(x) for x in d)

    # Check that only allowed symbols are contained
    if set(state).difference(&#39;+-01&#39;):
        raise ValueError(
            f&#34;Symbols {set(state).difference(&#39;+-01&#39;)} are not allowed.&#34;)

    # Check no dimensions are zero
    if (isinstance(d, int) and d &lt;= 0) or (isinstance(d, tuple) and
                                           any(d &lt;= 0 for d in d)):
        raise ValueError(&#34;All dimensions must be positive&#34;)

    # Check n_qubits and dimensions are consistent
    if len(d) != len(state):
        raise ValueError(&#34;Number of qubits and dimensions are not consistent.&#34;)

    # Simple cases
    if not set(state).difference([&#39;0&#39;, &#39;1&#39;]):
        # Initialize in the computational basis
        q_state = np.zeros(d, dtype=complex_type)
        q_state[tuple(int(b) for b in state)] = 1

    elif set(state) == {&#39;+&#39;}:
        # Initialize to superposition
        q_state = np.ones(d, dtype=complex_type) / np.sqrt(np.prod(d))

    else:
        # Get order
        order = argsort(state,
                        key=lambda x: {
                            &#39;0&#39;: 0,
                            &#39;1&#39;: 1,
                            &#39;+&#39;: 2,
                            &#39;-&#39;: 3
                        }[x])
        order = [order.index(i) for i in range(len(order))]

        # Get dimensions
        d_a0 = tuple(d for d, b in zip(d, state) if b in &#39;0&#39;)
        d_a1 = tuple(d for d, b in zip(d, state) if b in &#39;1&#39;)
        d_b = tuple(d for d, b in zip(d, state) if b == &#39;+&#39;)
        d_c = tuple(d for d, b in zip(d, state) if b == &#39;-&#39;)

        # Get size
        p_a0 = np.prod(d_a0).astype(int)
        p_a1 = np.prod(d_a1).astype(int)
        p_b = np.prod(d_b).astype(int)
        p_c = np.prod(d_c).astype(int)

        # Get number of dimensions
        n_a0 = len(d_a0)
        n_a1 = len(d_a1)
        n_b = len(d_b)
        n_c = len(d_c)

        # Check
        assert (n_a0 + n_a1 + n_b + n_c == len(state))

        # Initialize state
        q_state = np.zeros((p_a0 * p_a1, p_b, p_c), dtype=complex_type)

        # Assign state
        q_state[p_a1 - 1] = np.reshape(
            np.kron(np.ones(p_b), _parity(np.arange(p_c))) / np.sqrt(p_b * p_c),
            (p_b, p_c))

        # Reshape and transpose
        q_state = np.reshape(
            np.reshape(
                np.transpose(np.reshape(q_state, d_a0 + d_a1 + d_b + d_c),
                             order), (p_a0 * p_a1 * p_b * p_c,)), d)

    # Return state
    return q_state</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="hybridq.circuit.simulation.utils.prepare_state"><code class="name flex">
<span>def <span class="ident">prepare_state</span></span>(<span>state: str, d: {int, iter[int]} = 2, complex_type: any = 'complex64')</span>
</code></dt>
<dd>
<div class="desc"><p>Prepare initial state accordingly to <code>state</code>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>state</code></strong> :&ensp;<code>str</code></dt>
<dd>
<p>State used to prepare the quantum state. If <code>state</code> is a string, a
quantum state of <code>len(str)</code> is created using the following notation:</p>
<ul>
<li><code>0</code>: qubit is set to <code>0</code> in the computational basis,</li>
<li><code>1</code>: qubit is set to <code>1</code> in the computational basis,</li>
<li><code>+</code>: qubit is set to <code>+</code> state in the computational basis,</li>
<li><code>-</code>: qubit is set to <code>-</code> state in the computational basis.</li>
</ul>
</dd>
<dt><strong><code>d</code></strong> :&ensp;<code>{int, iter[int]}</code></dt>
<dd>Dimensions of qubits.</dd>
<dt><strong><code>complex_type</code></strong> :&ensp;<code>any</code>, optional</dt>
<dd>Complex type to use to prepare the quantum state.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Array</code></dt>
<dd>Quantum state prepared from <code>state</code>.</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; prepare_state('+-+')
array([ 0.35355338+0.j,  0.35355338+0.j, -0.35355338+0.j, -0.35355338+0.j,
        0.35355338+0.j,  0.35355338+0.j, -0.35355338+0.j, -0.35355338+0.j],
      dtype=complex64)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def prepare_state(state: str,
                  d: {int, iter[int]} = 2,
                  complex_type: any = &#39;complex64&#39;):
    &#34;&#34;&#34;
    Prepare initial state accordingly to `state`.

    Parameters
    ----------
    state: str
        State used to prepare the quantum state. If `state` is a string, a
        quantum state of `len(str)` is created using the following notation:

        - `0`: qubit is set to `0` in the computational basis,
        - `1`: qubit is set to `1` in the computational basis,
        - `+`: qubit is set to `+` state in the computational basis,
        - `-`: qubit is set to `-` state in the computational basis.
    d: {int, iter[int]}
        Dimensions of qubits.
    complex_type: any, optional
        Complex type to use to prepare the quantum state.

    Returns
    -------
    Array
        Quantum state prepared from `state`.

    Example
    -------
    &gt;&gt;&gt; prepare_state(&#39;+-+&#39;)
    array([ 0.35355338+0.j,  0.35355338+0.j, -0.35355338+0.j, -0.35355338+0.j,
            0.35355338+0.j,  0.35355338+0.j, -0.35355338+0.j, -0.35355338+0.j],
          dtype=complex64)
    &#34;&#34;&#34;
    # Convert state to str
    try:
        state = str(state)
    except:
        raise ValueError(&#34;&#39;state&#39; must be convertible to &#39;str&#39;.&#34;)

    # Get dimensions
    try:
        d = (int(d),) * len(state)
    except:
        d = tuple(int(x) for x in d)

    # Check that only allowed symbols are contained
    if set(state).difference(&#39;+-01&#39;):
        raise ValueError(
            f&#34;Symbols {set(state).difference(&#39;+-01&#39;)} are not allowed.&#34;)

    # Check no dimensions are zero
    if (isinstance(d, int) and d &lt;= 0) or (isinstance(d, tuple) and
                                           any(d &lt;= 0 for d in d)):
        raise ValueError(&#34;All dimensions must be positive&#34;)

    # Check n_qubits and dimensions are consistent
    if len(d) != len(state):
        raise ValueError(&#34;Number of qubits and dimensions are not consistent.&#34;)

    # Simple cases
    if not set(state).difference([&#39;0&#39;, &#39;1&#39;]):
        # Initialize in the computational basis
        q_state = np.zeros(d, dtype=complex_type)
        q_state[tuple(int(b) for b in state)] = 1

    elif set(state) == {&#39;+&#39;}:
        # Initialize to superposition
        q_state = np.ones(d, dtype=complex_type) / np.sqrt(np.prod(d))

    else:
        # Get order
        order = argsort(state,
                        key=lambda x: {
                            &#39;0&#39;: 0,
                            &#39;1&#39;: 1,
                            &#39;+&#39;: 2,
                            &#39;-&#39;: 3
                        }[x])
        order = [order.index(i) for i in range(len(order))]

        # Get dimensions
        d_a0 = tuple(d for d, b in zip(d, state) if b in &#39;0&#39;)
        d_a1 = tuple(d for d, b in zip(d, state) if b in &#39;1&#39;)
        d_b = tuple(d for d, b in zip(d, state) if b == &#39;+&#39;)
        d_c = tuple(d for d, b in zip(d, state) if b == &#39;-&#39;)

        # Get size
        p_a0 = np.prod(d_a0).astype(int)
        p_a1 = np.prod(d_a1).astype(int)
        p_b = np.prod(d_b).astype(int)
        p_c = np.prod(d_c).astype(int)

        # Get number of dimensions
        n_a0 = len(d_a0)
        n_a1 = len(d_a1)
        n_b = len(d_b)
        n_c = len(d_c)

        # Check
        assert (n_a0 + n_a1 + n_b + n_c == len(state))

        # Initialize state
        q_state = np.zeros((p_a0 * p_a1, p_b, p_c), dtype=complex_type)

        # Assign state
        q_state[p_a1 - 1] = np.reshape(
            np.kron(np.ones(p_b), _parity(np.arange(p_c))) / np.sqrt(p_b * p_c),
            (p_b, p_c))

        # Reshape and transpose
        q_state = np.reshape(
            np.reshape(
                np.transpose(np.reshape(q_state, d_a0 + d_a1 + d_b + d_c),
                             order), (p_a0 * p_a1 * p_b * p_c,)), d)

    # Return state
    return q_state</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#types">Types</a></li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="hybridq.circuit.simulation" href="index.html">hybridq.circuit.simulation</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="hybridq.circuit.simulation.utils.prepare_state" href="#hybridq.circuit.simulation.utils.prepare_state">prepare_state</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>